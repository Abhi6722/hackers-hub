"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[7475],{4137:function(e,t,o){o.d(t,{Zo:function(){return c},kt:function(){return h}});var r=o(7294);function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function a(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach((function(t){n(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function s(e,t){if(null==e)return{};var o,r,n=function(e,t){if(null==e)return{};var o,r,n={},a=Object.keys(e);for(r=0;r<a.length;r++)o=a[r],t.indexOf(o)>=0||(n[o]=e[o]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)o=a[r],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}var l=r.createContext({}),p=function(e){var t=r.useContext(l),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},c=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var o=e.components,n=e.mdxType,a=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=p(o),h=n,m=d["".concat(l,".").concat(h)]||d[h]||u[h]||a;return o?r.createElement(m,i(i({ref:t},c),{},{components:o})):r.createElement(m,i({ref:t},c))}));function h(e,t){var o=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var a=o.length,i=new Array(a);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var p=2;p<a;p++)i[p]=o[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,o)}d.displayName="MDXCreateElement"},8853:function(e,t,o){o.r(t),o.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return p},assets:function(){return c},toc:function(){return u},default:function(){return h}});var r=o(7462),n=o(3366),a=(o(7294),o(4137)),i=["components"],s={title:"WebdriverIO v7 Released",author:"Christian Bromann",authorURL:"http://twitter.com/bromann",authorImageURL:"https://s.gravatar.com/avatar/d98b16d7c93d15865f34a225dd4b1254?s=80"},l=void 0,p={permalink:"/blog/2021/02/09/webdriverio-v7-released",editUrl:"https://github.com/Abhi6722/hackers-hub/edit/main/website/blog/blog/2021-02-09-webdriverio-v7-released.md",source:"@site/blog/2021-02-09-webdriverio-v7-released.md",title:"WebdriverIO v7 Released",description:"It's the time of the year where the WebdriverIO project is releasing a new major update. It\u2019s almost become a tradition for us to rewrite the complete code base to further grow the project. When we announced the v5 update, we moved from a multi-repository setup to a mono-repo. This time, the rewrite of the code base is just as important and impactful, but comes with almost no implications for the end user. As more and more contributors have joined the project, we've noticed that using pure JavaScript can be helpful to keep the entry barrier for contributions low, but that it ultimately decreases the quality of contributions overall. With the growing size of the code in the project, keeping up with all the different types that were thrown around was becoming more difficult for us as core contributors. Since we already had a lot of TypeScript fans among us, we decided to move to TypeScript quickly after meeting at the OpenJS Collaborator Summit.",date:"2021-02-09T00:00:00.000Z",formattedDate:"February 9, 2021",tags:[],readingTime:8.11,truncated:!1,authors:[{name:"Christian Bromann",url:"http://twitter.com/bromann",imageURL:"https://s.gravatar.com/avatar/d98b16d7c93d15865f34a225dd4b1254?s=80"}],prevItem:{title:"Grouping Specs for Execution in a Single Instance",permalink:"/blog/2021/03/23/grouping-specs"},nextItem:{title:"New Network Primitives (Beta)",permalink:"/blog/2020/07/10/network-primitives"}},c={authorsImageUrls:[void 0]},u=[{value:"Drop Node v10 Support",id:"drop-node-v10-support",children:[],level:2},{value:"TypeScript Rewrite",id:"typescript-rewrite",children:[],level:2},{value:"Cucumber v7 Update",id:"cucumber-v7-update",children:[],level:2},{value:"Improved Google Lighthouse Integration",id:"improved-google-lighthouse-integration",children:[{value:"New PWA Check Command",id:"new-pwa-check-command",children:[],level:3}],level:2},{value:"Auto Compiling",id:"auto-compiling",children:[],level:2},{value:"Stricter Protocol Compliance",id:"stricter-protocol-compliance",children:[],level:2},{value:"Test Coverage Reporting",id:"test-coverage-reporting",children:[],level:2},{value:"New Docs",id:"new-docs",children:[],level:2}],d={toc:u};function h(e){var t=e.components,o=(0,n.Z)(e,i);return(0,a.kt)("wrapper",(0,r.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"It's the time of the year where the WebdriverIO project is releasing a new major update. It\u2019s almost become a tradition for us to rewrite the complete code base to further grow the project. When we ",(0,a.kt)("a",{parentName:"p",href:"/blog/2018/12/19/webdriverio-v5-released"},"announced the v5")," update, we moved from a multi-repository setup to a mono-repo. This time, the rewrite of the code base is just as important and impactful, but comes with almost no implications for the end user. As more and more contributors have joined the project, we've noticed that using pure JavaScript can be helpful to keep the entry barrier for contributions low, but that it ultimately decreases the quality of contributions overall. With the growing size of the code in the project, keeping up with all the different types that were thrown around was becoming more difficult for us as core contributors. Since we already had a lot of TypeScript fans among us, we decided to move to TypeScript quickly after meeting at the ",(0,a.kt)("a",{parentName:"p",href:"https://youtu.be/HqIstZSsCTA"},"OpenJS Collaborator Summit"),"."),(0,a.kt)("p",null,"Our hope is that by moving to TypeScript, fewer bugs will be introduced during continued development on the framework. It will help improve the quality of code contributions and the speed of development of certain features. It also brings more confidence in new versions that we ship to the user."),(0,a.kt)("p",null,"This major update will largely only impact TypeScript users as we have updated types in all places and changed the way we distribute them. As part of the rewrite, we upgraded to Cucumber v7, which also moved its codebase to TypeScript. Because of that we had to update some of the Cucumber hooks to ensure they come with proper type safety. In the following we go into every major change and will describe how you can upgrade to v7."),(0,a.kt)("h2",{id:"drop-node-v10-support"},"Drop Node v10 Support"),(0,a.kt)("p",null,"We've dropped support for Node v10, which was moved into a maintenance LTS phase by the Node.js team in May 2020. While this version still receives important security updates until April 2021, we recommend updating your Node.js version to v14 or higher."),(0,a.kt)("p",null,"To update Node.js, it is important to know how it was installed in the first place. If you are in a Docker environment, you can just upgrade the base image like:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-git"},"- FROM mhart/alpine-node:10\n+ FROM mhart/alpine-node:14\n")),(0,a.kt)("p",null,"We recommend using ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/nvm-sh/nvm"},"NVM")," (Node Version Manager) to install and manage Node.js versions. You can find a detailed description on how to install NVM and update Node in their ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/nvm-sh/nvm#installing-and-updating"},"project readme"),"."),(0,a.kt)("h2",{id:"typescript-rewrite"},"TypeScript Rewrite"),(0,a.kt)("p",null,"We have rewritten the complete code base and almost touched all files to add type safety and to fix a lot of bugs on the way. This was a true community effort and would have taken much longer if we didn\u2019t have so many people helping with code contributions. Thank you all for that \u2764\ufe0f! Before, WebdriverIO auto-generated all type definitions, which caused the creation of a lot of duplicate types and inconsistency. With this overhaul, all types are directly taken from the code itself and centralized in a single new helper package called ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/webdriverio/webdriverio/tree/main/packages/wdio-types"},(0,a.kt)("inlineCode",{parentName:"a"},"@wdio/types")),". If you have been using TypeScript, you will now have much better type support for various commands and the configuration file."),(0,a.kt)("p",null,"There are two significant changes how this TypeScript rewrite will impact you. While in v6 you would set ",(0,a.kt)("inlineCode",{parentName:"p"},"@wdio/sync")," in your types of your ",(0,a.kt)("inlineCode",{parentName:"p"},"tsconfig.json"),", this will now change to be ",(0,a.kt)("inlineCode",{parentName:"p"},"webdriverio/sync"),". Similar for running WebdriverIO asynchronously. Instead of just defining ",(0,a.kt)("inlineCode",{parentName:"p"},"webdriverio")," in your types you now need to set ",(0,a.kt)("inlineCode",{parentName:"p"},"webdriverio/async"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-git"},'// tsconfig.json\n"types": [\n  "node",\n-  "@wdio/sync",\n+  "webdriverio/sync",\n  "@wdio/mocha-framework"\n],\n')),(0,a.kt)("p",null,"or"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-git"},'// tsconfig.json\n"types": [\n  "node",\n-  "webdriverio",\n+  "webdriverio/async",\n  "@wdio/mocha-framework"\n],\n')),(0,a.kt)("p",null,"Lastly, if you define custom commands, you need to provide their types slightly different now, if using module-style type definition files (type definition file uses import/export; tsconfig.json contains ",(0,a.kt)("inlineCode",{parentName:"p"},"include")," section):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"// define custom commands in v6\ndeclare namespace WebdriverIO {\n    // adding command to `browser`\n    interface Browser {\n        browserCustomCommand: (arg: number) => void\n    }\n}\n")),(0,a.kt)("p",null,"this now has to be:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"declare global {\n    namespace WebdriverIO {\n        interface Browser {\n            browserCustomCommand: (arg: number) => void\n        }\n    }\n}\n")),(0,a.kt)("p",null,"Otherwise, if using ambient type definition files (no include section in tsconfig, no import/export in type definition file), then keep the custom command declaration the same as before, since including the ",(0,a.kt)("inlineCode",{parentName:"p"},"global")," declaration as above will require the type definition file to be changed to a module."),(0,a.kt)("p",null,"Alongside with this change we also equipped the testrunner to auto-compile your configuration if TypeScript is detected, this allows to leverage type safety in your WDIO configuration without any additional setup (big thanks for this contribution goes to ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/r4j4h"},"@r4j4h"),"). With that you also don't need ",(0,a.kt)("inlineCode",{parentName:"p"},"ts-node/register")," to be required in your Mocha, Jasmine or Cucumber options, e.g.:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-suggestion"},"jasmineOpts: {\n    - requires: ['ts-node/register', 'tsconfig-paths/register'],\n    + requires: ['tsconfig-paths/register'],\n},\n")),(0,a.kt)("p",null,"You can read more about WebdriverIO TypeScript integration in our ",(0,a.kt)("a",{parentName:"p",href:"/docs/typescript"},"docs"),"."),(0,a.kt)("h2",{id:"cucumber-v7-update"},"Cucumber v7 Update"),(0,a.kt)("p",null,"The folks working on Cucumber have done a tremendous job moving their code base to TypeScript, which has made our lives tremendously easier. The new Cucumber integration required us to update the parameters within our ",(0,a.kt)("a",{parentName:"p",href:"/docs/options#beforefeature"},"Cucumber hooks"),"."),(0,a.kt)("p",null,"If you have been using Cucumber, all you need to do to update to v7 is to update your Cucumber imports to their new package:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-git"},"- const { Given, When, Then } = require('cucumber')\n+ const { Given, When, Then } = require('@cucumber/cucumber')\n")),(0,a.kt)("h2",{id:"improved-google-lighthouse-integration"},"Improved Google Lighthouse Integration"),(0,a.kt)("p",null,"Since v6 WebdriverIO can run on the ",(0,a.kt)("a",{parentName:"p",href:"https://w3c.github.io/webdriver/"},"WebDriver protocol")," for true cross browser automation, but also automate specific browsers using browser APIs such as ",(0,a.kt)("a",{parentName:"p",href:"https://chromedevtools.github.io/devtools-protocol/"},"Chrome DevTools"),". This allows for interesting integrations into tools that allow broader testing capabilities such as ",(0,a.kt)("a",{parentName:"p",href:"https://developers.google.com/web/tools/lighthouse"},"Google Lighthouse"),". With the ",(0,a.kt)("inlineCode",{parentName:"p"},"@wdio/devtools-service"),", WebdriverIO users were able to access these capabilities using Google Lighthouse to run ",(0,a.kt)("a",{parentName:"p",href:"https://www.youtube.com/watch?v=Al7zlLdd_es"},"performance tests"),". In this release, we\u2019ve also updated Google Lighthouse to the latest version to enable new performance metrics such as ",(0,a.kt)("a",{parentName:"p",href:"https://web.dev/cls/"},"Cumulative Layout Shifts")," or ",(0,a.kt)("a",{parentName:"p",href:"https://web.dev/fid/"},"First Input Delay"),"."),(0,a.kt)("p",null,"While in v6 performance tests were automatically run on a mobile environment, we have decided to change this and make the default behavior more obvious. Therefore, if you run performance tests in v7, there aren't any changes to the environment where you run your tests. We still recommend emulating a mobile device to more accurately capture the user experience of users most impacted by bad application performance. To do so, you can run the following commands:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"browser.emulateDevice('iPhone X')\nbrowser.enablePerformanceAudits({\n    networkThrottling: 'Regular 3G',\n    cpuThrottling: 4,\n    cacheEnabled: false,\n    formFactor: 'mobile'\n})\n")),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"formFactor")," property has been added with the update to Google Lighthouse v7, which determines how performance metrics are scored and if mobile-only audits are skipped."),(0,a.kt)("h3",{id:"new-pwa-check-command"},"New PWA Check Command"),(0,a.kt)("p",null,"In addition,  we have deepened our integration to the tool and added audits for capturing the quality of your ",(0,a.kt)("a",{parentName:"p",href:"https://web.dev/progressive-web-apps/"},"progressive web apps")," (PWA). These applications are built with modern web APIs to deliver enhanced capabilities, reliability, and installability while reaching anyone, anywhere, on any device with a single codebase. To test if your application fulfills the PWA requirements we have introduced a ",(0,a.kt)("inlineCode",{parentName:"p"},"checkPWA")," command that runs a variety of audits, validating the set up of your app:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const result = browser.checkPWA()\nexpect(result.passed).toBe(true)\n")),(0,a.kt)("p",null,"We will continue to add more integrations into tools like Google Lighthouse to provide more testing capabilities, e.g. accessibility, best practices and SEO."),(0,a.kt)("h2",{id:"auto-compiling"},"Auto Compiling"),(0,a.kt)("p",null,"In v7 of WebdriverIO we made using compiler tools like Babel or TypeScript a lot easier. The testrunner can now automatically compile the config if it finds the necessary packages in your modules. Usually these had to be defined in your framework options like so:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"    mochaOpts: {\n        ui: 'bdd',\n        require: ['@babel/register'],\n        // ...\n    },\n")),(0,a.kt)("p",null,"These settings need to be removed now as WebdriverIO automatically includes them. Read more about how to set up ",(0,a.kt)("a",{parentName:"p",href:"/docs/babel"},"Babel")," or ",(0,a.kt)("a",{parentName:"p",href:"/docs/typescript"},"TypeScript")," in our docs."),(0,a.kt)("h2",{id:"stricter-protocol-compliance"},"Stricter Protocol Compliance"),(0,a.kt)("p",null,"The WebDriver protocol has been upgraded to a W3C recommended standard since 2018. A lot of cloud vendors and tools have been able to update their implementation making all artifacts of the JSONWireProtocol obsolete. The WebdriverIO projects wants to support this transition by adding additional checks to its capability configuration to ensure users don't accidentally send a mixture of both protocols resulting in an unexpected behavior. With the new version your session request will automatically fail if you send incompatible capabilities along, e.g.:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"capabilities: {\n    browserName: 'Chrome',\n    platform: 'Windows 10', // invalid JSONWire Protocol capability\n    'goog:chromeOptions': { ... }\n}\n")),(0,a.kt)("h2",{id:"test-coverage-reporting"},"Test Coverage Reporting"),(0,a.kt)("p",null,"The ",(0,a.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@wdio/devtools-service"},(0,a.kt)("inlineCode",{parentName:"a"},"@wdio/devtools-service"))," now offers to capture the code coverage of your JavaScript application files. This can help you to identify whether you should write more e2e tests or not. To enable the feature you have to enable it by setting the coverageReporter option for the service:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"// wdio.conf.js\nservices: [\n    ['devtools' {\n        coverageReporter: {\n            enable: true,\n            type: 'html',\n            logDir: __dirname + '/coverage'\n        }\n    }]\n]\n")),(0,a.kt)("p",null,"You can also assert the code coverage within your tests using the new ",(0,a.kt)("inlineCode",{parentName:"p"},"getCoverageReport")," command, e.g.:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const coverage = browser.getCoverageReport()\nexpect(coverage.lines.total).toBeAbove(0.9)\nexpect(coverage.statements.total).toBeAbove(0.9)\nexpect(coverage.functions.total).toBeAbove(0.9)\nexpect(coverage.branches.total).toBeAbove(0.9)\n")),(0,a.kt)("h2",{id:"new-docs"},"New Docs"),(0,a.kt)("p",null,"As you might already have seen, we have updated our ",(0,a.kt)("a",{parentName:"p",href:"https://webdriver.io"},"docs")," to give this new release a brand new face. We've upgraded our Docusaurus setup to v2 and gave the whole design a new touch. Big shout out to ",(0,a.kt)("a",{parentName:"p",href:"https://www.linkedin.com/in/antoschka-kartoschka"},"Anton Meier")," for helping us out and making our robot on the front page so lively."),(0,a.kt)("p",null,"That's it! We hope you enjoy the new version and update your framework soon-ish to get all these new features, type safety and bug fixes for your projects. If you have any questions don't hesitate to start a conversation on the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/webdriverio/webdriverio/discussions"},"discussions page")," or join our growing ",(0,a.kt)("a",{parentName:"p",href:"https://gitter.im/webdriverio/webdriverio"},"support chat")," that has already reached 6.7k active members."))}h.isMDXComponent=!0}}]);