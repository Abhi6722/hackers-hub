"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[9406],{4137:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return h}});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(n),h=o,d=u["".concat(l,".").concat(h)]||u[h]||m[h]||r;return n?a.createElement(d,i(i({ref:t},p),{},{components:n})):a.createElement(d,i({ref:t},p))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var c=2;c<r;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},3389:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return c},assets:function(){return p},toc:function(){return m},default:function(){return h}});var a=n(7462),o=n(3366),r=(n(7294),n(4137)),i=["components"],s={title:"Visual Regression for V5",author:"Wim Selles",authorURL:"http://github.com/wswebcreation",authorImageURL:"https://avatars2.githubusercontent.com/u/11979740?s=460&v=4"},l=void 0,c={permalink:"/blog/2019/05/18/visual-regression-for-v5",editUrl:"https://github.com/Abhi6722/hackers-hub/edit/main/website/blog/blog/2019-05-18-visual-regression-for-v5.md",source:"@site/blog/2019-05-18-visual-regression-for-v5.md",title:"Visual Regression for V5",description:"We are pleased to announce that we now have a new Visual Regression service for WebdriverIO V5 called wdio-image-comparison-service.",date:"2019-05-18T00:00:00.000Z",formattedDate:"May 18, 2019",tags:[],readingTime:4.505,truncated:!1,authors:[{name:"Wim Selles",url:"http://github.com/wswebcreation",imageURL:"https://avatars2.githubusercontent.com/u/11979740?s=460&v=4"}],prevItem:{title:"File Uploads with WebdriverIO",permalink:"/blog/2019/06/25/file-upload"},nextItem:{title:"React Selectors",permalink:"/blog/2019/04/03/react-selectors"}},p={authorsImageUrls:[void 0]},m=[{value:"What can it do?",id:"what-can-it-do",children:[],level:2},{value:"Installation",id:"installation",children:[],level:2},{value:"Usage",id:"usage",children:[{value:"Configuration",id:"configuration",children:[],level:3},{value:"Writing tests",id:"writing-tests",children:[],level:3},{value:"Nice new feature",id:"nice-new-feature",children:[],level:3},{value:"Test result outputs",id:"test-result-outputs",children:[],level:3}],level:2}],u={toc:m};function h(e){var t=e.components,s=(0,o.Z)(e,i);return(0,r.kt)("wrapper",(0,a.Z)({},u,s,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"We are pleased to announce that we now have a new Visual Regression service for WebdriverIO V5 called ",(0,r.kt)("inlineCode",{parentName:"p"},"wdio-image-comparison-service"),"."),(0,r.kt)("h2",{id:"what-can-it-do"},"What can it do?"),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"wdio-image-comparison-service")," is a lightweight ",(0,r.kt)("em",{parentName:"p"},"WebdriverIO")," service for browsers / mobile browsers / hybrid apps to do image comparison on screens, elements or full page screens."),(0,r.kt)("p",null,"You can:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"save or compare screens / elements / full page screens against a baseline"),(0,r.kt)("li",{parentName:"ul"},"automatically create a baseline when no baseline is there"),(0,r.kt)("li",{parentName:"ul"},"blockout custom regions and even automatically exclude a status and or tool bars (mobile only) during a comparison"),(0,r.kt)("li",{parentName:"ul"},"increase the element dimensions screenshots"),(0,r.kt)("li",{parentName:"ul"},"use different comparison methods"),(0,r.kt)("li",{parentName:"ul"},"and much more, see the ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/wswebcreation/wdio-image-comparison-service/blob/master/docs/OPTIONS.md"},"options here"))),(0,r.kt)("p",null,"The module is now based on the power of the new ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/wswebcreation/webdriver-image-comparison"},(0,r.kt)("inlineCode",{parentName:"a"},"webdriver-image-comparison"))," module. This is a lightweight module to retrieve the needed data and screenshots for all browsers / devices.\nThe comparison power comes from ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/Huddle/Resemble.js"},"ResembleJS"),". If you want to compare images online you can check the ",(0,r.kt)("a",{parentName:"p",href:"https://rsmbl.github.io/Resemble.js/"},"online tool"),"."),(0,r.kt)("p",null,"It can be used for:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"desktop browsers (Chrome / Firefox / Safari / Internet Explorer 11 / Microsoft Edge)"),(0,r.kt)("li",{parentName:"ul"},"mobile / tablet browsers (Chrome / Safari on emulators / real devices) via Appium"),(0,r.kt)("li",{parentName:"ul"},"Hybrid apps via Appium")),(0,r.kt)("p",null,"For versions check below:"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://eu-central-1.saucelabs.com/u/wdio-image-comparison-service"},(0,r.kt)("img",{parentName:"a",src:"https://eu-central-1.saucelabs.com/browser-matrix/wdio-image-comparison-service.svg",alt:"Sauce Test Status"}))),(0,r.kt)("h2",{id:"installation"},"Installation"),(0,r.kt)("p",null,"Install this module locally with the following command to be used as a (dev-)dependency:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash",metastring:"npm2yarn",npm2yarn:!0},"npm install --save-dev wdio-image-comparison-service\n")),(0,r.kt)("p",null,"Instructions on how to install ",(0,r.kt)("inlineCode",{parentName:"p"},"WebdriverIO")," can be found ",(0,r.kt)("a",{parentName:"p",href:"http://webdriver.io/guide/getstarted/install.html"},"here.")),(0,r.kt)("h2",{id:"usage"},"Usage"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"wdio-image-comparison-service")," supports NodeJS 8 or higher"))),(0,r.kt)("h3",{id:"configuration"},"Configuration"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"wdio-image-comparison-service")," is a service so it can be used as a normal service. You can set it up in your ",(0,r.kt)("inlineCode",{parentName:"p"},"wdio.conf.js")," file with the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const { join } = require('path');\n\n// wdio.conf.js\nexports.config = {\n    // ...\n    // =====\n    // Setup\n    // =====\n    services: [\n        ['image-comparison',\n        // The options\n        {\n            // Some options, see the docs for more\n            baselineFolder: join(process.cwd(), './tests/sauceLabsBaseline/'),\n            formatImageName: '{tag}-{logName}-{width}x{height}',\n            screenshotPath: join(process.cwd(), '.tmp/'),\n            savePerInstance: true,\n            autoSaveBaseline: true,\n            blockOutStatusBar: true,\n            blockOutToolBar: true,\n            // ... more options\n        }],\n    ],\n    // ...\n};\n")),(0,r.kt)("p",null,"More plugin options can be found ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/wswebcreation/wdio-image-comparison-service/blob/master/docs/OPTIONS.md#plugin-options"},"here"),"."),(0,r.kt)("h3",{id:"writing-tests"},"Writing tests"),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"wdio-image-comparison-service")," is framework agnostic, meaning that you can use it with all the frameworks WebdriverIO supports like ",(0,r.kt)("inlineCode",{parentName:"p"},"Jasmine|Mocha"),".\nYou can use it like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"describe('Example', () => {\n  beforeEach(() => {\n     browser.url('https://webdriver.io');\n  });\n\n  it('should save some screenshots', () => {\n    // Save a screen\n    browser.saveScreen('examplePaged', { /* some options*/ });\n\n    // Save an element\n    browser.saveElement($('#element-id'), 'firstButtonElement', { /* some options*/ });\n\n    // Save a full page screens\n    browser.saveFullPageScreen('fullPage', { /* some options*/ });\n  });\n\n  it('should compare successful with a baseline', () => {\n    // Check a screen\n    expect(browser.checkScreen('examplePaged', { /* some options*/ })).toEqual(0);\n\n    // Check an element\n    expect(browser.checkElement($('#element-id'), 'firstButtonElement', { /* some options*/ })).toEqual(0);\n\n    // Check a full page screens\n    expect(browser.checkFullPageScreen('fullPage', { /* some options*/ })).toEqual(0);\n  });\n});\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"If you run for the first time without having a baseline the ",(0,r.kt)("inlineCode",{parentName:"strong"},"check"),"-methods will reject the promise with the following warning:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"#####################################################################################\n Baseline image not found, save the actual image manually to the baseline.\n The image can be found here:\n /Users/wswebcreation/Git/wdio-image-comparison-service/.tmp/actual/desktop_chrome/examplePage-chrome-latest-1366x768.png\n If you want the module to auto save a non existing image to the baseline you\n can provide 'autoSaveBaseline: true' to the options.\n#####################################################################################\n\n")),(0,r.kt)("p",null,"This means that the current screenshot is saved in the actual folder and you ",(0,r.kt)("strong",{parentName:"p"},"manually need to copy it to your baseline"),".\nIf you instantiate ",(0,r.kt)("inlineCode",{parentName:"p"},"wdio-image-comparison-service")," with ",(0,r.kt)("inlineCode",{parentName:"p"},"autoSaveBaseline: true")," the image will automatically be saved into the baseline folder."),(0,r.kt)("h3",{id:"nice-new-feature"},"Nice new feature"),(0,r.kt)("p",null,"When you create a fullpage screenshot you might have some elements that stay in the view, like a stickyheader or a chatbox.\nThese elements normally mess up the screenshot like you can see on the left side of the below image."),(0,r.kt)("p",null,"But you can now add elements that need to be hidden after the first scroll which will give you a result as you can see in the right side of the below image.\nThis can be done by adding this property to your test:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"browser.checkFullPageScreen('fullPage', {\n    hideAfterFirstScroll: [\n        $('nav-bar'),\n        $('chat-box'),\n    ],\n});\n")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"fullpage-example",src:n(3854).Z})),(0,r.kt)("h3",{id:"test-result-outputs"},"Test result outputs"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"save(Screen/Element/FullPageScreen)")," methods will provide the following information after the method has been executed:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const saveResult = {\n  // The device pixel ratio of the instance that has run\n  devicePixelRatio: 1,\n  // The formatted filename, this depends on the options `formatImageName`\n  fileName: 'examplePage-chrome-latest-1366x768.png',\n  // The path where the actual screenshot file can be found\n  path: '/Users/wswebcreation/Git/wdio-image-comparison-service/.tmp/actual/desktop_chrome',\n};\n")),(0,r.kt)("p",null,"See the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/wswebcreation/wdio-image-comparison-service/blob/master/docs/OUTPUT.md#save-output"},"Save output")," section in the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/wswebcreation/wdio-image-comparison-service/blob/master/docs/OUTPUT.md"},"output")," docs for the images."),(0,r.kt)("p",null,"By default the ",(0,r.kt)("inlineCode",{parentName:"p"},"check(Screen/Element/FullPageScreen)")," methods will only provide a mismatch percentage like ",(0,r.kt)("inlineCode",{parentName:"p"},"1.23"),", but when the plugin has the options ",(0,r.kt)("inlineCode",{parentName:"p"},"returnAllCompareData: true")," the following information is provided after the method has been executed:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const checkResult = {\n  // The formatted filename, this depends on the options `formatImageName`\n  fileName: 'examplePage-chrome-headless-latest-1366x768.png',\n  folders: {\n      // The actual folder and the file name\n      actual: '/Users/wswebcreation/Git/wdio-image-comparison-service/.tmp/actual/desktop_chrome/examplePage-chrome-headless-latest-1366x768.png',\n      // The baseline folder and the file name\n      baseline: '/Users/wswebcreation/Git/wdio-image-comparison-service/localBaseline/desktop_chrome/examplePage-chrome-headless-latest-1366x768.png',\n      // This following folder is optional and only if there is a mismatch\n      // The folder that holds the diffs and the file name\n      diff: '/Users/wswebcreation/Git/wdio-image-comparison-service/.tmp/diff/desktop_chrome/examplePage-chrome-headless-latest-1366x768.png',\n    },\n    // The mismatch percentage\n    misMatchPercentage: 2.34\n};\n")),(0,r.kt)("p",null,"See the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/wswebcreation/wdio-image-comparison-service/blob/master/docs/OUTPUT.md#check-output-on-failure"},"Check output on failure")," section in the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/wswebcreation/wdio-image-comparison-service/blob/master/docs/OUTPUT.md"},"output")," docs for the images."),(0,r.kt)("h1",{id:"support"},"Support"),(0,r.kt)("p",null,"If you need support you can find me on the ",(0,r.kt)("inlineCode",{parentName:"p"},"wdio-image-comparison-service"),"- Gitter channel, or click on this link ",(0,r.kt)("a",{parentName:"p",href:"https://gitter.im/wswebcreation/wdio-image-comparison-service",title:"Gitter chat"},(0,r.kt)("img",{parentName:"a",src:"https://badges.gitter.im/wswebcreation/wdio-image-comparison-service.png",alt:"Gitter chat"}))),(0,r.kt)("p",null,"Happy testing!"),(0,r.kt)("p",null,"Grtz,"),(0,r.kt)("p",null,"The Blue Guy"))}h.isMDXComponent=!0},3854:function(e,t,n){t.Z=n.p+"assets/images/image-comparison-d0f95397ac4e3d96a16813ac14b90ae5.jpg"}}]);